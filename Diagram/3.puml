@startuml
left to right direction
skinparam packageStyle rectangle
skinparam shadowing false
skinparam actorStyle awesome

'--- กำหนดผู้ใช้งาน (Actors) ---
actor "เจ้าของโครงการ/ผู้ขอเบิก" as User
actor "เจ้าหน้าที่พัสดุ" as Officer
actor "หัวหน้าเจ้าหน้าที่/ผู้อนุมัติ" as Approver
actor "คณะกรรมการตรวจรับ" as Committee

rectangle "ระบบจัดซื้อวัสดุภาครัฐ (Government Material Procurement)" {

    '--- Group 1: บริหารโครงการและงบประมาณ ---
    usecase "นำเข้าโครงการและงบประมาณ\n(Import Project & Budget)" as UC01
    usecase "ตรวจสอบวงเงินคงเหลือ\n(Check Budget Balance)" as UC02

    '--- Group 2: ขอซื้อ (PR) ---
    usecase "สร้างใบขอซื้อ (Create PR)" as UC03
    usecase "อนุมัติหลักการ (Approve PR)" as UC04

    '--- Group 3: จัดหาและสั่งซื้อ (PO) ---
    usecase "สรรหาผู้ขาย/สืบราคา\n(Sourcing)" as UC05
    usecase "ออกใบสั่งซื้อ (Create PO)" as UC06
    usecase "อนุมัติสั่งซื้อ/ลงนามสัญญา\n(Sign Contract/PO)" as UC07

    '--- Group 4: ตรวจรับและคลัง (Inspection & Stock) ---
    usecase "บันทึกผลการตรวจรับ\n(Inspection Record)" as UC08
    usecase "คำนวณค่าปรับ\n(Calculate Penalty)" as UC09
    usecase "รับวัสดุเข้าคลัง\n(Stock In / Update Inventory)" as UC10
    
}

'--- ความสัมพันธ์ (Relationships) ---

' 1. User/Requester
User --> UC01 : สร้างแผน
User --> UC03 : ขอซื้อวัสดุ

' 2. Logic ความสัมพันธ์ภายใน
UC03 ..> UC02 : <<include>>\n(ต้องเช็คงบก่อนเสมอ)
UC03 ..> UC01 : <<include>>\n(อ้างอิงโครงการ)

' 3. Approver Flow
Approver --> UC04
Approver --> UC07

' 4. Officer Flow (คนทำงานหลัก)
Officer --> UC05 : ดำเนินการ
Officer --> UC06 : จัดทำเอกสาร
Officer --> UC10 : อัปเดตบัญชีวัสดุ

' 5. Committee Flow
Committee --> UC08 : ตรวจสอบของ

' 6. ความซับซ้อน (Extend & Include)
UC06 ..> UC05 : <<include>>\n(ต้องมีผู้ขายก่อน)
UC08 <.. UC09 : <<extend>>\n(กรณีส่งมอบล่าช้า)
UC08 ..> UC06 : <<include>>\n(อ้างอิง PO)
UC10 ..> UC08 : <<include>>\n(ต้องตรวจผ่านถึงรับเข้าได้)

note right of UC02
  ระบบต้อง Lock วงเงิน (Reserve)
  ทันทีที่มีการสร้าง PR
end note

note right of UC09
  ระบบคิดค่าปรับอัตโนมัติ
  ตามวันที่กำหนดใน PO
  เทียบกับวันที่ส่งของจริง
end note

@enduml