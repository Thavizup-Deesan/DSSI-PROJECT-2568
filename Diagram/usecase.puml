@startuml
title Use Case Diagram: ระบบจัดซื้อวัสดุภาครัฐ (Offline Approval Flow)
left to right direction
skinparam packageStyle rectangle

' --- Actors ---
actor "เจ้าหน้าที่พัสดุ\n(Officer)" as Officer
actor "ผู้เข้าร่วมโครงการ\n(User)" as User
actor "กรรมการตรวจรับ\n(Inspection Committee)" as Committee
actor "ระบบอัตโนมัติ\n(System)" as System <<Secondary>>

rectangle "ระบบจัดซื้อวัสดุภาครัฐ (System Boundary)" {

    ' --- Group 1: Project Setup ---
    usecase "UC-01: นำเข้าและตั้งค่าโครงการ\n(Import & Setup Project)" as UC01
    usecase "UC-02: ระบุผู้รับผิดชอบโครงการ\n(Assign Participants)" as UC02
    usecase "UC-03: เริ่มโครงการ\n(Start Project)" as UC03

    ' --- Group 2: Ordering ---
    usecase "UC-04: สร้างใบสั่งซื้อ\n(Create Order)" as UC04
    usecase "UC-04a: แก้ไขใบสั่งซื้อ\n(Edit Order)" as UC05
    usecase "UC-05: ตรวจสอบวงเงินคงเหลือ\n(Check Budget)" as UC06
    
    ' --- Group 3: Export for Offline Process ---
    usecase "UC-06: กันวงเงินและ Export ข้อมูล\n(Reserve & Export Data)" as UC07
    
    note bottom of UC07
        <b>Offline Process:</b>
        นำเอกสารไปให้หัวหน้าภาคเซ็นอนุมัติ
        - ถ้าอนุมัติ -> ไปขั้นตอน UC-08
        - ถ้าแก้ไข -> แจ้ง User ทำ UC-04a
    end note

    ' --- Group 4: Fulfillment ---
    usecase "UC-08: สร้างใบสั่งซื้อย่อยและแนบใบเสร็จ\n(Create Sub-Order & Upload Receipt)" as UC09
    usecase "UC-10: ตรวจรับพัสดุ\n(Inspect Goods)" as UC10
    usecase "UC-10a: ยืนยัน/ปฏิเสธ การตรวจรับ\n(Confirm/Reject Inspection)" as UC11

    ' --- Group 5: Closing ---
    usecase "UC-11: คำนวณยอดและตั้งเบิกจ่าย\n(Process Payment)" as UC12
    usecase "UC-12: สรุปและปิดโครงการ\n(Close Project)" as UC13

    ' --- Relationships ---

    ' Officer Actions
    Officer -- UC01
    Officer -- UC02
    Officer -- UC03
    Officer -- UC07
    Officer -- UC09
    Officer -- UC12
    Officer -- UC13

    ' User Actions
    User -- UC04
    User -- UC05

    ' Committee Actions
    Committee -- UC10

    ' System Actions
    UC06 -- System : Auto Check
    UC12 -- System : Auto Calculate

    ' --- Logic & Dependencies ---
    
    ' Ordering Logic
    UC04 ..> UC06 : <<include>>
    UC05 .> UC04 : <<extend>> 
    note on link
        กรณีงบไม่พอ หรือ
        หัวหน้าแจ้งแก้ไข (Offline)
    end note

    ' Inspection Logic
    UC09 ..> UC10 : prerequisite
    UC11 .> UC10 : <<extend>>
    
    ' Payment Logic
    UC12 .> UC11 : <<include>>
}

@enduml