@startuml
skinparam state {
  BackgroundColor<<Auth>> LightBlue
  BackgroundColor<<Admin>> LightCoral
  BackgroundColor<<User>> LightGreen
  BackgroundColor<<Committee>> LightPurple
}

[*] --> LoginPage

' === Authentication ===
state "หน้าเข้าสู่ระบบ\n(Login Page)" as LoginPage <<Auth>>
state "หน้าลงทะเบียน\n(Register Page)" as RegisterPage <<Auth>>

' === Admin Section ===
state "จัดการบัญชีผู้ใช้\n(User Management)" as AdminUsers <<Admin>>

' === User/Staff Section (ใช้หน้าเดียวกัน) ===
state "แดชบอร์ดผู้ขอซื้อ\n(Requester Dashboard)" as UserDash <<User>>
state "เลือกโครงการ\n(Select Project)" as SelectProject <<User>>
state "รายการโครงการ\n(Project List)" as ProjectList <<User>>
state "สร้างใบขอซื้อ\n(Create Order)" as CreateOrder <<User>>
state "รายการใบขอซื้อ\n(My Orders)" as MyOrders <<User>>
state "รายละเอียดใบขอซื้อ\n(Order Detail)" as OrderDetail <<User>>
state "แก้ไขใบขอซื้อ\n(Edit Order)" as EditOrder <<User>>
state "หน้า QR Code\n(Order QR)" as OrderQR <<User>>
state "บันทึกการรับของ\n(Receive Items)" as ReceiveItems <<User>>

' === Committee Section ===
state "สแกนดูรายการ\n(Scan Order)" as ScanOrder <<Committee>>

' === Transitions ===

' Auth Flow
LoginPage --> RegisterPage : กดลงทะเบียน
RegisterPage --> LoginPage : ลงทะเบียนสำเร็จ

LoginPage --> AdminUsers : Login (Role: Admin)
LoginPage --> UserDash : Login (Role: User/Staff/Boss)

' Logout
AdminUsers --> LoginPage : Logout
UserDash --> LoginPage : Logout

' Admin Flow
AdminUsers : เพิ่ม/แก้ไข/ลบผู้ใช้
AdminUsers : เปลี่ยน Role
AdminUsers : รีเซ็ตรหัสผ่าน

' User/Staff Flow - พัสดุ
UserDash --> SelectProject : สร้างใบขอซื้อพัสดุ/ครุภัณฑ์
SelectProject --> ProjectList : เลือกประเภท
ProjectList --> CreateOrder : เลือกโครงการ
CreateOrder --> MyOrders : บันทึก/ส่ง

UserDash --> MyOrders : ดูรายการใบขอซื้อ
MyOrders --> OrderDetail : ดูรายละเอียด
OrderDetail --> EditOrder : แก้ไข (Draft เท่านั้น)
EditOrder --> OrderDetail : บันทึก
OrderDetail --> OrderQR : ดู QR Code
OrderDetail --> ReceiveItems : บันทึกรับของ
ReceiveItems --> OrderDetail : บันทึกสำเร็จ

' Committee Flow (Mobile)
ScanOrder : สแกน QR จากมือถือ
ScanOrder : ดูรายการสินค้า (อ่านอย่างเดียว)

@enduml

' User Flow - พัสดุ
UserDash --> SelectProject : สร้างใบขอซื้อพัสดุ
SelectProject --> ProjectList : เลือกประเภท
ProjectList --> CreateOrder : เลือกโครงการ
CreateOrder --> MyOrders : บันทึก/ส่ง

UserDash --> MyOrders : ดูรายการใบขอซื้อ
MyOrders --> OrderDetail : ดูรายละเอียด
OrderDetail --> EditOrder : แก้ไข
EditOrder --> OrderDetail : บันทึก
OrderDetail --> OrderQR : ดู QR Code
OrderDetail --> ReceiveItems : บันทึกรับของ
ReceiveItems --> OrderDetail : บันทึกสำเร็จ

UserDash --> OrderHistory : ประวัติใบขอซื้อ
OrderHistory --> OrderDetail : ดูรายละเอียด

' Committee Flow (Mobile)
ScanOrder : สแกน QR จากมือถือ
ScanOrder : ดูรายการสินค้า (อ่านอย่างเดียว)

@enduml