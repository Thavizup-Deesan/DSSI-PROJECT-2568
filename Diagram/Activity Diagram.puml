@startuml
title System Flow Diagram: ระบบจัดการติดตามการสั่งซื้อของโครงการ

' --- ตั้งค่ารูปแบบ ---
skinparam backgroundColor white
skinparam activity {
  BackgroundColor #FEFECE
  BorderColor #A80036
  ArrowColor #A80036
}
skinparam swimlane {
  BackgroundColor #F0F8FF
  BorderColor Black
}

' --- เริ่มต้น Flow แบบ Swimlane แบ่งตามผู้รับผิดชอบ ---

|Admin / เจ้าหน้าที่จัดซื้อ (Staff)|
start
:1. เข้าสู่ระบบ;
:2. จัดการข้อมูลหลัก (Master Data)\n(โครงการ, ผู้ขาย, พัสดุ);

|ผู้ใช้งาน / ผู้ขอซื้อ (User)|
:3. เข้าสู่ระบบ;
:4. ดูโครงการที่ตนเองรับผิดชอบ;
:5. สร้างใบขอซื้อ (Create PR)\n- เลือกโครงการ\n- เลือกพัสดุ\n- ระบุจำนวน;
:6. บันทึกและส่งใบขอซื้อ;

|Admin / เจ้าหน้าที่จัดซื้อ (Staff)|
:7. รับการแจ้งเตือน / ดูรายการรออนุมัติ;
:8. ตรวจสอบรายละเอียดใบขอซื้อ;

if (ผลการพิจารณา?) then (ไม่อนุมัติ)
  :9a. ปฏิเสธ (Reject) / ส่งคืนแก้ไข;
  
  |ผู้ใช้งาน / ผู้ขอซื้อ (User)|
  :10a. รับทราบสถานะไม่อนุมัติ;
  :11a. แก้ไขใบขอซื้อ หรือ ยกเลิก;
  if (ต้องการส่งใหม่?) then (ใช่)
    goto 6
  else (ไม่)
    stop
  endif

else (อนุมัติ)
  |Admin / เจ้าหน้าที่จัดซื้อ (Staff)|
  :9b. อนุมัติใบขอซื้อ (Approve);
  :10b. สร้างใบสั่งซื้อ (Generate PO)\nอ้างอิงจาก PR ที่อนุมัติ;
  :11b. ส่งใบสั่งซื้อให้ผู้ขาย (Vendor)\n(พิมพ์ PDF / Email);
  :12b. อัปเดตสถานะเป็น "กำลังดำเนินการ";
endif

|ผู้ใช้งาน / ผู้ขอซื้อ (User)|
:13. รอรับพัสดุจากผู้ขาย;
:14. ตรวจสอบพัสดุที่ได้รับ;
:15. บันทึกยืนยันการรับของ (Good Receipt);

|Admin / เจ้าหน้าที่จัดซื้อ (Staff)|
:16. ตรวจสอบการรับของ;
:17. ปิดใบสั่งซื้อ (Close PO);
:18. สรุปรายงานผลการจัดซื้อ;

stop
@enduml