# ğŸ“ Code Examples - Request/Response Implementation

## 1. Frontend - JavaScript Fetch Examples

### **1.1 Fetch GET - à¸”à¸¶à¸‡à¸£à¸²à¸¢à¸Šà¸·à¹ˆà¸­à¹‚à¸„à¸£à¸‡à¸à¸²à¸£**

```javascript
// ============================================
// Simple GET Request
// ============================================
async function fetchAllProjects() {
  try {
    // à¸ªà¹ˆà¸‡ GET request à¹„à¸›à¸¢à¸±à¸‡ backend
    const response = await fetch("/api/projects/", {
      method: "GET",
      headers: {
        "Content-Type": "application/json",
      },
    });

    // à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸² response à¸ªà¸³à¹€à¸£à¹‡à¸ˆ
    if (!response.ok) {
      throw new Error(`HTTP Error: ${response.status}`);
    }

    // à¹à¸›à¸¥à¸‡ JSON response à¹€à¸›à¹‡à¸™ JavaScript object
    const projects = await response.json();

    // projects à¸—à¸µà¹ˆà¹„à¸”à¹‰à¸„à¸·à¸™:
    // [
    //   {
    //     "project_id": 1,
    //     "project_code": "PRJ-001",
    //     "project_name": "à¸£à¸°à¸šà¸šà¸ªà¸²à¸£à¸ªà¸™à¹€à¸—à¸¨à¹€à¸‚à¸•",
    //     "budget_total": "150000.00",
    //     "status": "à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£"
    //   },
    //   { ... more projects ... }
    // ]

    return projects;
  } catch (error) {
    console.error("Failed to fetch projects:", error);
    alert("âš ï¸ à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹„à¸”à¹‰: " + error.message);
    throw error;
  }
}

// à¹ƒà¸Šà¹‰ function
fetchAllProjects().then((projects) => {
  console.log("à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸³à¹€à¸£à¹‡à¸ˆ! à¸ˆà¸³à¸™à¸§à¸™:", projects.length);
  // â† à¸—à¸³à¸à¸²à¸£à¹à¸ªà¸”à¸‡ data à¹ƒà¸™ table
});
```

---

### **1.2 Fetch GET (à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸‰à¸à¸²à¸°)**

```javascript
// ============================================
// GET Single Record by ID
// ============================================
async function fetchProjectByCode(projectCode) {
  try {
    const response = await fetch(`/api/projects/${projectCode}/`, {
      method: "GET",
      headers: {
        "Content-Type": "application/json",
      },
    });

    if (!response.ok) {
      if (response.status === 404) {
        throw new Error(`à¹„à¸¡à¹ˆà¸à¸šà¹‚à¸„à¸£à¸‡à¸à¸²à¸£: ${projectCode}`);
      }
      throw new Error(`HTTP Error: ${response.status}`);
    }

    const project = await response.json();

    // project object à¸—à¸µà¹ˆà¹„à¸”à¹‰:
    // {
    //   "project_id": 1,
    //   "project_code": "PRJ-001",
    //   "project_name": "à¸£à¸°à¸šà¸šà¸ªà¸²à¸£à¸ªà¸™à¹€à¸—à¸¨à¹€à¸‚à¸•",
    //   "budget_total": "150000.00",
    //   "status": "à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£"
    // }

    return project;
  } catch (error) {
    console.error("Error:", error);
    throw error;
  }
}

// à¹ƒà¸Šà¹‰ function
fetchProjectByCode("PRJ-001").then((project) => {
  console.log("à¹‚à¸„à¸£à¸‡à¸à¸²à¸£:", project.project_name);
  console.log("à¸‡à¸šà¸›à¸£à¸°à¸¡à¸²à¸“:", project.budget_total);
});
```

---

### **1.3 Fetch POST - à¹€à¸à¸´à¹ˆà¸¡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥**

```javascript
// ============================================
// POST Request - Create New Record
// ============================================
async function createNewProject(projectData) {
  try {
    // projectData à¸—à¸µà¹ˆà¸ªà¹ˆà¸‡à¹„à¸›:
    // {
    //   "project_code": "PRJ-007",
    //   "project_name": "à¸£à¸°à¸šà¸šà¹ƒà¸«à¸¡à¹ˆ",
    //   "budget_total": 300000,
    //   "status": "à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£"
    // }

    const response = await fetch("/api/projects/", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "X-CSRFToken": getCookie("csrftoken"), // âš ï¸ Django CSRF Protection
      },
      body: JSON.stringify(projectData), // âœ… Convert object to JSON string
    });

    if (!response.ok) {
      const errorData = await response.json();
      // errorData à¸­à¸²à¸ˆà¸ˆà¸°:
      // {
      //   "project_code": ["This field may not be blank."],
      //   "budget_total": ["A valid number is required."]
      // }
      console.error("Validation errors:", errorData);
      throw new Error("Validation failed: " + JSON.stringify(errorData));
    }

    // âœ… Success! Parse response
    const createdProject = await response.json();

    // createdProject à¸—à¸µà¹ˆà¹„à¸”à¹‰:
    // {
    //   "project_id": 7,  â† Auto-generated by Django
    //   "project_code": "PRJ-007",
    //   "project_name": "à¸£à¸°à¸šà¸šà¹ƒà¸«à¸¡à¹ˆ",
    //   "budget_total": "300000.00",
    //   "status": "à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£"
    // }

    console.log("âœ… à¸ªà¸£à¹‰à¸²à¸‡à¹‚à¸„à¸£à¸‡à¸à¸²à¸£à¸ªà¸³à¹€à¸£à¹‡à¸ˆ! ID:", createdProject.project_id);
    return createdProject;
  } catch (error) {
    console.error("Failed to create project:", error);
    alert("âŒ à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸”: " + error.message);
    throw error;
  }
}

// à¹ƒà¸Šà¹‰ function
const newProject = {
  project_code: "PRJ-007",
  project_name: "à¸£à¸°à¸šà¸šà¹ƒà¸«à¸¡à¹ˆ",
  budget_total: 300000,
  status: "à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£",
};

createNewProject(newProject).then((result) => {
  console.log("à¹‚à¸„à¸£à¸‡à¸à¸²à¸£", result.project_code, "à¸–à¸¹à¸à¸ªà¸£à¹‰à¸²à¸‡à¹à¸¥à¹‰à¸§");
});
```

---

### **1.4 Fetch PUT - à¹à¸à¹‰à¹„à¸‚à¸‚à¹‰à¸­à¸¡à¸¹à¸¥**

```javascript
// ============================================
// PUT Request - Update Existing Record
// ============================================
async function updateProject(projectCode, updates) {
  try {
    // updates à¸—à¸µà¹ˆà¸ªà¹ˆà¸‡à¹„à¸› (à¸ªà¹ˆà¸§à¸™à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¹à¸à¹‰à¹„à¸‚):
    // {
    //   "project_name": "à¸£à¸°à¸šà¸šà¸ªà¸²à¸£à¸ªà¸™à¹€à¸—à¸¨à¹€à¸‚à¸• (à¸›à¸£à¸±à¸šà¸›à¸£à¸¸à¸‡)",
    //   "budget_total": 160000
    // }
    // Note: à¹„à¸¡à¹ˆà¸ˆà¸³à¹€à¸›à¹‡à¸™à¸•à¹‰à¸­à¸‡à¸ªà¹ˆà¸‡à¸—à¸¸à¸à¸Ÿà¸´à¸¥à¸”à¹Œ

    const response = await fetch(`/api/projects/${projectCode}/`, {
      method: "PUT", // âš ï¸ Use PUT for update
      headers: {
        "Content-Type": "application/json",
        "X-CSRFToken": getCookie("csrftoken"),
      },
      body: JSON.stringify(updates),
    });

    if (!response.ok) {
      const errorData = await response.json();
      throw new Error("Update failed: " + JSON.stringify(errorData));
    }

    const updatedProject = await response.json();

    // updatedProject à¸—à¸µà¹ˆà¹„à¸”à¹‰ (à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸¡à¸šà¸¹à¸£à¸“à¹Œ):
    // {
    //   "project_id": 1,
    //   "project_code": "PRJ-001",  â† à¹„à¸¡à¹ˆà¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™
    //   "project_name": "à¸£à¸°à¸šà¸šà¸ªà¸²à¸£à¸ªà¸™à¹€à¸—à¸¨à¹€à¸‚à¸• (à¸›à¸£à¸±à¸šà¸›à¸£à¸¸à¸‡)",  â† Updated
    //   "budget_total": "160000.00",  â† Updated
    //   "status": "à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£"  â† à¹„à¸¡à¹ˆà¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™
    // }

    console.log("âœ… à¸­à¸±à¸›à¹€à¸”à¸•à¸ªà¸³à¹€à¸£à¹‡à¸ˆ");
    return updatedProject;
  } catch (error) {
    console.error("Failed to update project:", error);
    throw error;
  }
}

// à¹ƒà¸Šà¹‰ function
const updates = {
  project_name: "à¸£à¸°à¸šà¸šà¸ªà¸²à¸£à¸ªà¸™à¹€à¸—à¸¨à¹€à¸‚à¸• (à¸›à¸£à¸±à¸šà¸›à¸£à¸¸à¸‡)",
  budget_total: 160000,
};

updateProject("PRJ-001", updates).then((result) => {
  console.log("à¸­à¸±à¸›à¹€à¸”à¸•:", result.project_name);
});
```

---

### **1.5 Fetch DELETE - à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥**

```javascript
// ============================================
// DELETE Request - Remove Record
// ============================================
async function deleteProject(projectCode) {
  try {
    // à¸¢à¸·à¸™à¸¢à¸±à¸™à¸à¹ˆà¸­à¸™à¸¥à¸š
    const confirm_delete = confirm(`à¸„à¸¸à¸“à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸¥à¸š ${projectCode} à¹ƒà¸Šà¹ˆà¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ?`);
    if (!confirm_delete) {
      console.log("à¸¢à¸à¹€à¸¥à¸´à¸à¸à¸²à¸£à¸¥à¸š");
      return false;
    }

    const response = await fetch(`/api/projects/${projectCode}/`, {
      method: "DELETE", // âš ï¸ Use DELETE
      headers: {
        "X-CSRFToken": getCookie("csrftoken"),
      },
      // âŒ à¹„à¸¡à¹ˆà¸¡à¸µ body à¸ªà¸³à¸«à¸£à¸±à¸š DELETE
    });

    // âš ï¸ Important: DELETE response is 204 No Content
    // à¹„à¸¡à¹ˆà¸¡à¸µ response body!
    if (response.status === 204) {
      console.log("âœ… à¸¥à¸šà¸ªà¸³à¹€à¸£à¹‡à¸ˆ");
      return true;
    } else {
      throw new Error(`Unexpected status: ${response.status}`);
    }
  } catch (error) {
    console.error("Failed to delete project:", error);
    alert("âŒ à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸”à¹ƒà¸™à¸à¸²à¸£à¸¥à¸š: " + error.message);
    throw error;
  }
}

// à¹ƒà¸Šà¹‰ function
deleteProject("PRJ-007").then((success) => {
  if (success) {
    console.log("à¸¥à¸šà¹€à¸ªà¸£à¹‡à¸ˆà¹à¸¥à¹‰à¸§ - reload table");
    // â† Reload project list
  }
});
```

---

### **1.6 Fetch POST - Upload File (Import Excel)**

```javascript
// ============================================
// POST Request with File - Import Excel
// ============================================
async function importExcelFile(file) {
  try {
    // âš ï¸ Important: Use FormData for file upload
    const formData = new FormData();
    formData.append("importFile", file); // Key name à¸•à¹‰à¸­à¸‡à¸•à¸£à¸‡à¸à¸±à¸š backend

    // FormData à¸—à¸µà¹ˆà¸ªà¸£à¹‰à¸²à¸‡à¸ˆà¸°à¸–à¸¹à¸ browser convert à¹€à¸›à¹‡à¸™:
    // Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW
    // ------WebKitFormBoundary7MA4YWxkTrZu0gW
    // Content-Disposition: form-data; name="importFile"; filename="projects.xlsx"
    // Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
    // [Binary file content...]

    const response = await fetch("/api/projects/import-excel/", {
      method: "POST",
      headers: {
        // âš ï¸ à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¸•à¸±à¹‰à¸‡ Content-Type - browser à¸ˆà¸°à¸•à¸±à¹‰à¸‡à¹ƒà¸«à¹‰à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´!
        "X-CSRFToken": getCookie("csrftoken"),
      },
      body: formData, // âœ… Send FormData, not JSON
    });

    if (!response.ok) {
      const errorData = await response.json();
      // errorData à¸­à¸²à¸ˆà¸ˆà¸°:
      // {
      //   "error": "Missing required columns in Excel file"
      // }
      // à¸«à¸£à¸·à¸­
      // {
      //   "error": "Error at row 2: {'project_code': ['This field may not be blank.']}"
      // }
      throw new Error(errorData.error || "Import failed");
    }

    const result = await response.json();

    // result à¸—à¸µà¹ˆà¹„à¸”à¹‰:
    // {
    //   "message": "Successfully imported/updated 10 projects."
    // }

    console.log("âœ… Import à¸ªà¸³à¹€à¸£à¹‡à¸ˆ:", result.message);
    return result;
  } catch (error) {
    console.error("Import failed:", error);
    alert("âŒ " + error.message);
    throw error;
  }
}

// à¹ƒà¸Šà¹‰ function
document.getElementById("importFile").addEventListener("change", async (e) => {
  const file = e.target.files[0];
  if (file) {
    try {
      const result = await importExcelFile(file);
      console.log(result.message);
      // â† Reload project list
    } catch (error) {
      console.error("Error:", error);
    }
  }
});
```

---

### **1.7 Helper Function - Get CSRF Token**

```javascript
// ============================================
// Helper: Get CSRF Token from Cookie
// ============================================
function getCookie(name) {
  let cookieValue = null;

  if (document.cookie && document.cookie !== "") {
    // Split cookies by semicolon
    const cookies = document.cookie.split(";");

    for (let i = 0; i < cookies.length; i++) {
      const cookie = cookies[i].trim();

      // Check if this cookie is what we're looking for
      if (cookie.substring(0, name.length + 1) === name + "=") {
        // Extract cookie value and decode
        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
        break;
      }
    }
  }

  return cookieValue;
}

// Example:
const csrfToken = getCookie("csrftoken");
console.log("CSRF Token:", csrfToken);
// â† Typical output: csrftoken=abc123def456ghi789jkl...
```

---

## 2. Backend - Django Response Examples

### **2.1 ProjectViewSet - Create View**

```python
# views.py
from rest_framework import viewsets, status
from rest_framework.response import Response
from .models import Projects
from .serializers import ProjectSerializer

class ProjectViewSet(viewsets.ModelViewSet):
    queryset = Projects.objects.all()
    serializer_class = ProjectSerializer
    lookup_field = 'project_code'

    # ============================================
    # POST /api/projects/ - Create new project
    # ============================================
    def create(self, request, *args, **kwargs):
        """
        Handle POST request to create new project

        Request body example:
        {
          "project_code": "PRJ-008",
          "project_name": "à¸£à¸°à¸šà¸šà¹ƒà¸«à¸¡à¹ˆ",
          "budget_total": 250000,
          "status": "à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£"
        }
        """

        # 1ï¸âƒ£ Get request data
        request_data = request.data
        print(f"Creating project: {request_data}")

        # 2ï¸âƒ£ Initialize serializer with request data
        serializer = self.get_serializer(data=request_data)

        # 3ï¸âƒ£ Validate data
        # This will check:
        # - All required fields present
        # - Data types are correct
        # - Unique constraints (project_code must be unique)
        # - Any custom validation
        if not serializer.is_valid():
            # âŒ Validation failed
            # Response: 400 Bad Request
            return Response(
                serializer.errors,
                status=status.HTTP_400_BAD_REQUEST
            )

        # 4ï¸âƒ£ Validation passed! Save to database
        # This calls: Projects.objects.create(...)
        # which executes: INSERT INTO projects (...) VALUES (...)
        self.perform_create(serializer)

        # 5ï¸âƒ£ Return response
        # Response: 201 Created + JSON data of created object
        return Response(
            serializer.data,
            status=status.HTTP_201_CREATED
        )

    def perform_create(self, serializer):
        """
        This method is called by create() to save the object
        """
        # serializer.save() calls:
        # 1. Django ORM: Projects(**validated_data)
        # 2. database: INSERT INTO projects (...)
        # 3. Returns: Projects object with auto-generated project_id
        saved_instance = serializer.save()
        print(f"Project saved with ID: {saved_instance.project_id}")
        return saved_instance
```

---

### **2.2 ProjectViewSet - Retrieve View**

```python
# views.py (continued)

class ProjectViewSet(viewsets.ModelViewSet):
    # ...

    # ============================================
    # GET /api/projects/{project_code}/
    # ============================================
    def retrieve(self, request, project_code=None, *args, **kwargs):
        """
        Handle GET request to retrieve single project by code

        URL: GET /api/projects/PRJ-001/
        Response: 200 OK + JSON object
        """

        # 1ï¸âƒ£ Lookup object by project_code (lookup_field)
        # This executes: SELECT * FROM projects WHERE project_code = 'PRJ-001'
        try:
            project = Projects.objects.get(project_code=project_code)
        except Projects.DoesNotExist:
            # âŒ Not found
            # Response: 404 Not Found
            return Response(
                {'detail': 'Not found.'},
                status=status.HTTP_404_NOT_FOUND
            )

        # 2ï¸âƒ£ Serialize data
        serializer = self.get_serializer(project)

        # 3ï¸âƒ£ Return response
        # Response: 200 OK + JSON data
        return Response(
            serializer.data,
            status=status.HTTP_200_OK
        )

    # ============================================
    # GET /api/projects/
    # ============================================
    def list(self, request, *args, **kwargs):
        """
        Handle GET request to retrieve all projects

        URL: GET /api/projects/
        Response: 200 OK + JSON array
        """

        # 1ï¸âƒ£ Get all projects from database
        # This executes: SELECT * FROM projects
        queryset = self.get_queryset()

        # 2ï¸âƒ£ Serialize all objects
        serializer = self.get_serializer(queryset, many=True)

        # 3ï¸âƒ£ Return response
        # Response: 200 OK + JSON array of objects
        return Response(
            serializer.data,
            status=status.HTTP_200_OK
        )
```

---

### **2.3 ProjectViewSet - Update View**

```python
# views.py (continued)

class ProjectViewSet(viewsets.ModelViewSet):
    # ...

    # ============================================
    # PUT /api/projects/{project_code}/
    # ============================================
    def update(self, request, project_code=None, *args, **kwargs):
        """
        Handle PUT request to update project

        URL: PUT /api/projects/PRJ-001/
        Request body:
        {
          "project_name": "à¸£à¸°à¸šà¸š A (Updated)",
          "budget_total": 160000
        }
        Response: 200 OK + JSON object (full updated data)
        """

        # 1ï¸âƒ£ Lookup object by project_code
        try:
            project = Projects.objects.get(project_code=project_code)
        except Projects.DoesNotExist:
            return Response(
                {'detail': 'Not found.'},
                status=status.HTTP_404_NOT_FOUND
            )

        # 2ï¸âƒ£ Initialize serializer with existing object + new data
        # partial=True allows partial update (don't require all fields)
        serializer = self.get_serializer(
            project,  # Existing instance
            data=request.data,  # New data to update
            partial=True  # Allow partial fields
        )

        # 3ï¸âƒ£ Validate new data
        if not serializer.is_valid():
            return Response(
                serializer.errors,
                status=status.HTTP_400_BAD_REQUEST
            )

        # 4ï¸âƒ£ Save updated object
        # This executes: UPDATE projects SET ... WHERE project_code = 'PRJ-001'
        self.perform_update(serializer)

        # 5ï¸âƒ£ Return response
        # Response: 200 OK + complete updated JSON
        return Response(
            serializer.data,
            status=status.HTTP_200_OK
        )

    def perform_update(self, serializer):
        """Save the updated object"""
        serializer.save()
```

---

### **2.4 ProjectViewSet - Delete View**

```python
# views.py (continued)

class ProjectViewSet(viewsets.ModelViewSet):
    # ...

    # ============================================
    # DELETE /api/projects/{project_code}/
    # ============================================
    def destroy(self, request, project_code=None, *args, **kwargs):
        """
        Handle DELETE request to remove project

        URL: DELETE /api/projects/PRJ-001/
        Response: 204 No Content (no body!)
        """

        # 1ï¸âƒ£ Lookup object
        try:
            project = Projects.objects.get(project_code=project_code)
        except Projects.DoesNotExist:
            return Response(
                {'detail': 'Not found.'},
                status=status.HTTP_404_NOT_FOUND
            )

        # 2ï¸âƒ£ Delete object
        # This executes: DELETE FROM projects WHERE project_code = 'PRJ-001'
        self.perform_destroy(project)

        # 3ï¸âƒ£ Return response
        # Response: 204 No Content (no body!)
        # Important: 204 status means success with no response body
        return Response(status=status.HTTP_204_NO_CONTENT)

    def perform_destroy(self, instance):
        """Delete the instance"""
        instance.delete()
```

---

### **2.5 ProjectViewSet - Import Excel**

```python
# views.py (continued)
import pandas as pd
from rest_framework.decorators import action

class ProjectViewSet(viewsets.ModelViewSet):
    # ...

    # ============================================
    # POST /api/projects/import-excel/
    # ============================================
    @action(detail=False, methods=['post'], url_path='import-excel')
    def import_excel(self, request, *args, **kwargs):
        """
        Handle POST request to import/update projects from Excel file

        URL: POST /api/projects/import-excel/
        Request: multipart/form-data with 'importFile'
        Response: 201 Created + {"message": "..."}
        """

        # 1ï¸âƒ£ Get uploaded file from request
        file = request.FILES.get('importFile')

        if not file:
            # âŒ No file provided
            return Response(
                {'error': 'No file uploaded'},
                status=status.HTTP_400_BAD_REQUEST
            )

        try:
            # 2ï¸âƒ£ Read Excel file
            # pandas reads .xlsx or .xls files
            df = pd.read_excel(file)

            # 3ï¸âƒ£ Validate required columns
            required_columns = ['project_code', 'project_name', 'budget_total', 'status']
            if not all(col in df.columns for col in required_columns):
                return Response(
                    {'error': 'Missing required columns in Excel file'},
                    status=status.HTTP_400_BAD_REQUEST
                )

            # 4ï¸âƒ£ Process each row
            for index, row in df.iterrows():
                project_code = row['project_code']
                data = {
                    'project_name': row['project_name'],
                    'budget_total': row['budget_total'],
                    'status': row['status']
                }

                # Check if project exists
                project = Projects.objects.filter(project_code=project_code).first()

                if project:
                    # âœ… Update existing project
                    serializer = self.get_serializer(project, data=data, partial=True)
                else:
                    # âœ… Create new project
                    data['project_code'] = project_code
                    serializer = self.get_serializer(data=data)

                # Validate and save
                if serializer.is_valid():
                    serializer.save()
                else:
                    # âŒ Validation error
                    return Response(
                        {'error': f'Error at row {index + 2}: {serializer.errors}'},
                        status=status.HTTP_400_BAD_REQUEST
                    )

            # 5ï¸âƒ£ All rows processed successfully
            return Response(
                {'message': f'Successfully imported/updated {len(df)} projects.'},
                status=status.HTTP_201_CREATED
            )

        except Exception as e:
            # âŒ Error reading/processing file
            return Response(
                {'error': str(e)},
                status=status.HTTP_400_BAD_REQUEST
            )
```

---

### **2.6 Serializer - Validation**

```python
# serializers.py
from rest_framework import serializers
from .models import Projects

class ProjectSerializer(serializers.ModelSerializer):
    class Meta:
        model = Projects
        fields = '__all__'  # ['project_id', 'project_code', 'project_name', ...]

    # ============================================
    # Automatic Validation by DRF
    # ============================================
    # When serializer.is_valid() is called:
    # 1. Check all required fields exist
    # 2. Check field data types match model definition
    # 3. Run field-level validators
    # 4. Run object-level validators
    # 5. Check unique_together constraints

    # Custom validation example:
    def validate_budget_total(self, value):
        """
        Validate budget_total field
        This is called for field-level validation
        """
        if value < 0:
            raise serializers.ValidationError("Budget must be positive")
        return value

    def validate(self, data):
        """
        Validate entire object
        This is called for object-level validation
        """
        # Example: Add custom validation logic
        if data['status'] not in ['à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£', 'à¸›à¸´à¸”']:
            raise serializers.ValidationError(
                {'status': 'Invalid status'}
            )
        return data
```

---

## 3. Complete Request/Response Flow (with Actual Code)

### **Scenario: Create new project with error handling**

```javascript
// ============================================
// FRONTEND - Complete Example
// ============================================

async function createProjectComplete() {
  const projectData = {
    project_code: "PRJ-009",
    project_name: "à¸£à¸°à¸šà¸šà¸à¸²à¸£à¸ˆà¸±à¸”à¸à¸²à¸£à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸œà¸¥",
    budget_total: 400000,
    status: "à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£",
  };

  try {
    // 1ï¸âƒ£ Create request
    const response = await fetch("/api/projects/", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "X-CSRFToken": getCookie("csrftoken"),
      },
      body: JSON.stringify(projectData),
    });

    // 2ï¸âƒ£ Check response status
    if (response.status === 201) {
      // âœ… Created successfully
      const newProject = await response.json();
      console.log("âœ… à¸ªà¸£à¹‰à¸²à¸‡à¹‚à¸„à¸£à¸‡à¸à¸²à¸£à¸ªà¸³à¹€à¸£à¹‡à¸ˆ");
      console.log("  Project ID:", newProject.project_id);
      console.log("  Project Code:", newProject.project_code);
      alert("âœ… à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸³à¹€à¸£à¹‡à¸ˆ!");
      return newProject;
    } else if (response.status === 400) {
      // âŒ Validation error
      const errors = await response.json();
      console.error("âŒ Validation errors:", errors);

      // Format error message
      let errorMsg = "à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡:\n";
      for (const [field, messages] of Object.entries(errors)) {
        errorMsg += `${field}: ${messages.join(", ")}\n`;
      }
      alert(errorMsg);
      throw new Error("Validation failed");
    } else if (response.status === 404) {
      // âŒ Not found
      alert("âŒ à¹„à¸¡à¹ˆà¸à¸š endpoint");
      throw new Error("Endpoint not found");
    } else {
      // âŒ Other error
      alert(`âŒ à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸” (${response.status})`);
      throw new Error(`HTTP ${response.status}`);
    }
  } catch (error) {
    console.error("Exception caught:", error);
    // Handle error
  }
}

// à¹ƒà¸Šà¹‰ function
createProjectComplete()
  .then(() => {
    // â† Reload project list
    switchTab("projects");
  })
  .catch((error) => {
    console.error("Failed:", error);
  });
```

---

## 4. Network Inspection (DevTools Example)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Chrome DevTools - Network Tab                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚ â¬‡ï¸ REQUEST (what browser sends)                    â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚ General:                                            â”‚
â”‚   Request URL: http://localhost:8000/api/projects/ â”‚
â”‚   Request Method: POST                              â”‚
â”‚   Status Code: 201 Created                          â”‚
â”‚   Remote Address: 127.0.0.1:8000                    â”‚
â”‚                                                     â”‚
â”‚ Request Headers:                                    â”‚
â”‚   Host: localhost:8000                              â”‚
â”‚   Content-Type: application/json                    â”‚
â”‚   X-CSRFToken: abc123...                            â”‚
â”‚   Content-Length: 120                               â”‚
â”‚                                                     â”‚
â”‚ Request Payload:                                    â”‚
â”‚   {                                                 â”‚
â”‚     "project_code": "PRJ-009",                      â”‚
â”‚     "project_name": "à¸£à¸°à¸šà¸šà¸à¸²à¸£à¸ˆà¸±à¸”à¸à¸²à¸£à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸œà¸¥",     â”‚
â”‚     "budget_total": 400000,                         â”‚
â”‚     "status": "à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£"                           â”‚
â”‚   }                                                 â”‚
â”‚                                                     â”‚
â”‚ â¬†ï¸ RESPONSE (what server sends back)               â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚ Response Headers:                                   â”‚
â”‚   Content-Type: application/json                    â”‚
â”‚   Content-Length: 155                               â”‚
â”‚   Status: 201 Created                               â”‚
â”‚                                                     â”‚
â”‚ Response Body:                                      â”‚
â”‚   {                                                 â”‚
â”‚     "project_id": 9,                                â”‚
â”‚     "project_code": "PRJ-009",                      â”‚
â”‚     "project_name": "à¸£à¸°à¸šà¸šà¸à¸²à¸£à¸ˆà¸±à¸”à¸à¸²à¸£à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸œà¸¥",     â”‚
â”‚     "budget_total": "400000.00",                    â”‚
â”‚     "status": "à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£"                           â”‚
â”‚   }                                                 â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… à¸ªà¸£à¸¸à¸› Code Flow

1. **Frontend sends Request** (JavaScript) â†’ `/api/projects/` (POST)
2. **Backend receives** (Django) â†’ URLRouter â†’ ProjectViewSet.create()
3. **Serializer validates** (ProjectSerializer) â†’ Check data
4. **Database saves** (Django ORM) â†’ INSERT SQL â†’ MySQL
5. **Backend returns Response** (JSON) â†’ Status 201 Created
6. **Frontend processes** (JavaScript) â†’ Parse JSON â†’ Update UI
7. **User sees result** â†’ Table updated / Alert shown

**Time: ~100-300ms total** ğŸš€
