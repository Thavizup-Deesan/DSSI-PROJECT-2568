# Phase 3: ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå "‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠" (My Orders)

## üìã ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ User ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á:
- ‡∏î‡∏π‡∏â‡∏ö‡∏±‡∏ö‡∏£‡πà‡∏≤‡∏á (Draft)
- ‡∏î‡∏π‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏•‡∏ö Draft ‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏™‡πà‡∏á

---

## üóÉÔ∏è Table ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ (Firebase Collection)

**Collection:** `orders`

```javascript
{
  id: "auto-generated",
  project_id: "xxx",
  requester_id: "xxx",        // User ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á
  order_title: "‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á",
  order_description: "‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î",
  vendor_name: "‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤",
  items: [...],               // ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
  total_estimated_price: 1000,
  status: "Draft" | "Ordered" | "Approved" | "Closed",
  created_at: timestamp,
  updated_at: timestamp
}
```

---

## üîß ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á View Function

**‡πÑ‡∏ü‡∏•‡πå:** `api/views.py`

```python
def my_orders_view(request):
    """
    ===================================================================
    my_orders_view - ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á User
    ===================================================================
    
    URL: /api/my-orders/
    
    ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:
    - ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á User
    - ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (Draft, Ordered, etc.)
    - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏•‡∏ö Draft
    ===================================================================
    """
    return render(request, 'my_orders.html')
```

#### üß† ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ Syntax ‡πÅ‡∏•‡∏∞ Logic:

| ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î | ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
|--------|--------|
| `def my_orders_view(request):` | ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô view ‡∏£‡∏±‡∏ö `request` ‡πÄ‡∏õ‡πá‡∏ô parameter ‡πÅ‡∏£‡∏Å‡πÄ‡∏™‡∏°‡∏≠ |
| `"""..."""` | Docstring ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô |
| `return render(request, 'my_orders.html')` | ‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô HTML template ‡∏ó‡∏µ‡πà‡∏ä‡∏∑‡πà‡∏≠ `my_orders.html` |
| `render()` | ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ç‡∏≠‡∏á Django ‡πÅ‡∏õ‡∏•‡∏á template ‡πÄ‡∏õ‡πá‡∏ô HTTP Response |

---

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏û‡∏¥‡πà‡∏° URL Pattern

**‡πÑ‡∏ü‡∏•‡πå:** `api/urls.py`

```python
# 1. ‡πÄ‡∏û‡∏¥‡πà‡∏° import
from .views import (..., my_orders_view)

# 2. ‡πÄ‡∏û‡∏¥‡πà‡∏° URL pattern
urlpatterns = [
    ...
    path('my-orders/', my_orders_view, name='my-orders'),
]
```

#### üß† ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ Syntax ‡πÅ‡∏•‡∏∞ Logic:

| ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î | ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
|--------|--------|
| `from .views import ...` | import view function ‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå views.py |
| `path('my-orders/', ...)` | ‡∏Å‡∏≥‡∏´‡∏ô‡∏î URL pattern ‡∏ó‡∏µ‡πà `/api/my-orders/` |
| `my_orders_view` | ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤ URL ‡∏ô‡∏µ‡πâ |
| `name='my-orders'` | ‡∏ä‡∏∑‡πà‡∏≠ URL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÉ‡∏ô template |

---

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏™‡∏£‡πâ‡∏≤‡∏á HTML Template

**‡πÑ‡∏ü‡∏•‡πå:** `api/templates/my_orders.html`

```html
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô - POTMS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
    <!-- Content -->
    <script>
        // JavaScript ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å API
        async function loadOrders() {
            const user = JSON.parse(localStorage.getItem('user'));
            const res = await fetch(`/api/orders/?user_id=${user.id}`);
            const orders = await res.json();
            // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•...
        }
    </script>
</body>
</html>
```

#### üß† ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ Syntax ‡πÅ‡∏•‡∏∞ Logic:

| ‡∏™‡πà‡∏ß‡∏ô | ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
|------|--------|
| `localStorage.getItem('user')` | ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• user ‡∏ó‡∏µ‡πà login ‡∏≠‡∏¢‡∏π‡πà |
| `JSON.parse(...)` | ‡πÅ‡∏õ‡∏•‡∏á string ‡πÄ‡∏õ‡πá‡∏ô JavaScript object |
| `fetch('/api/orders/?user_id=xxx')` | ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ orders ‡∏û‡∏£‡πâ‡∏≠‡∏° filter |
| `await res.json()` | ‡πÅ‡∏õ‡∏•‡∏á response ‡πÄ‡∏õ‡πá‡∏ô JSON object |

---

## üìä API ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ

### GET /api/orders/

‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ orders ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏° user_id

**Request:**
```
GET /api/orders/?user_id=abc123
```

**Response:**
```json
[
  {
    "id": "order001",
    "order_title": "‡∏Ç‡∏≠‡∏ã‡∏∑‡πâ‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô",
    "status": "Draft",
    "total_estimated_price": 5000,
    "created_at": "2024-12-22"
  }
]
```

---

## üé® UI/UX Design

### ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏´‡∏•‡∏±‡∏Å:
1. **Header** - ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤ + ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö
2. **Filter** - ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
3. **‡∏ï‡∏≤‡∏£‡∏≤‡∏á** - ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ orders
4. **Actions** - ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏•‡∏ö (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Draft)

### ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏•‡∏∞‡∏™‡∏µ:
| ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏™‡∏µ | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢ |
|-------|-----|----------|
| Draft | üîµ Blue | ‡∏â‡∏ö‡∏±‡∏ö‡∏£‡πà‡∏≤‡∏á |
| Ordered | üü° Yellow | ‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ |
| Approved | üü¢ Green | ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß |
| Closed | ‚ö´ Gray | ‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß |

---

## üîÑ Flow ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

```
User ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ /api/my-orders/
        ‚Üì
JavaScript ‡∏î‡∏∂‡∏á user.id ‡∏à‡∏≤‡∏Å localStorage
        ‚Üì
‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API: GET /api/orders/?user_id=xxx
        ‚Üì
‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        ‚Üì
User ‡∏Å‡∏î "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç" ‚Üí ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ create-order (edit mode)
User ‡∏Å‡∏î "‡∏•‡∏ö" ‚Üí ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API DELETE
```

---

## üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á

| ‡πÑ‡∏ü‡∏•‡πå | ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà |
|------|--------|
| `api/views.py` | ‡πÄ‡∏û‡∏¥‡πà‡∏° `my_orders_view` function |
| `api/urls.py` | ‡πÄ‡∏û‡∏¥‡πà‡∏° URL pattern `/my-orders/` |
| `api/templates/my_orders.html` | ‡∏´‡∏ô‡πâ‡∏≤ HTML |
